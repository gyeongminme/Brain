# μ‹¤μµ 02
# ν…μ¤νΈ!
import os
import secrets
from openai import OpenAI
import streamlit as st
import requests
import pandas as pd

LiB_API_KEY = "ce0c893b3fcd2b1080903988f1fdd1367c7f811cdcad7d0a3a2ab99666816111"

os.environ["OPENAI_API_KEY"] = st.secrets["API_KEY"]
client = OpenAI(api_key=os.environ.get("OPENAI_API_KEY"),)

# μ•± μ λ©
st.title("π“λ„μ„ μ¶”μ² μ‹μ¤ν…π“")
st.subheader('μ„λΉ„μ¤ μ μ‘μ¤‘.')

st.divider()

# μ¬λ£ μ…λ ¥ λ°›κΈ°
#food = st.text_input("aa .")
key = st.secrets[Lib_API_KEY]
url = "http://data4library.kr/api/extends/loanItemSrchByLib?authKey=[ce0c893b3fcd2b1080903988f1fdd1367c7f811cdcad7d0a3a2ab99666816111]&libCode=[λ„μ„κ΄€μ½”λ“] "

api_key = st.secrets["Lib_API_KEY"]
# API ν‚¤ μ¶λ ¥ (ν…μ¤νΈμ©)
st.write(f"Loaded API Key: {api_key}")
 
#http://data4library.kr/api/loanItemSrch?authKey=ce0c893b3fcd2b1080903988f1fdd1367c7f811cdcad7d0a3a2ab99666816111&startDt=2022-01-01&endDt=2022-03-31& 
#gender=1&age=20&region=11;31&addCode=0&kdc=6&pageNo=1&pageSize=10

# Streamlit μ•± μ λ©
st.title("λ„μ„κ΄€ λ§μ¶¤ λ„μ„ μ¶”μ² μ‹μ¤ν…")
st.divider()

# 1. μ΅°ν μΌμ μ…λ ¥ startdt end dt
#2. μ—°λ Ήμ„ μ…λ ¥ν•μ‹μ¤ age 
#3. μ„±λ³„ gender
#4. νμ΄μ§€ ν¬κΈ° - ν• νμ΄μ§€λ‹Ή μ κ³ λλ” λ„μ„λ©λ΅ κ°μ μ§€μ • pagesize
#5. λ„μ„κµ¬λ¶„ class_no λ¶„λ¥μ½”λ“ 

# 1. μ΅°ν μΌμ μ…λ ¥ startdt end dt
st.header("1. μ΅°ν μΌμμ λ²”μ„λ¥Ό μ•λ ¤μ£Όμ„Έμ”")
# λ‚ μ§μ™€ μ‹κ°„ μ…λ ¥
st.write("λ‹Ήμ›”μ μ§‘κ³„λ” λ‹¤μλ‹¬μ— λ‚μ¤λ‹ μ΄μ „ λ‹¬κΉμ§€ μ΅°νν•μ‹λ” κ²ƒμ„ μ¶”μ²λ“λ¦½λ‹λ‹¤.");
selected_start_date = st.date_input("λ²”μ„μ μ‹μ‘ λ‚ μ§λ¥Ό μ„ νƒν•μ„Έμ”")
selected_end_time = st.date_input("λ²”μ„μ λ λ‚ μ§μ„ μ„ νƒν•μ„Έμ”")

# κ²°κ³Ό μ¶λ ¥
st.write("μ„ νƒν• λ‚ μ§μ™€ μ‹κ°„:")
st.write(f"{selected_start_date} {selected_end_time}")

st.divider()


#st.header("1. λ„μ„κ΄€ μ„ νƒ")
#library_options = ["λ„μ„κ΄€ A", "λ„μ„κ΄€ B", "λ„μ„κ΄€ C"]  # λ„μ„κ΄€ λ¦¬μ¤νΈ (APIλ΅ κ°€μ Έμ¬ μ μμ)
#selected_library = st.selectbox("λ„μ„κ΄€μ„ μ„ νƒν•μ„Έμ”:", library_options)


#2. μ—°λ Ήμ„ μ…λ ¥ν•μ‹μ¤ age 
age_start = -1
age_end = -1
st.header("2. μ΅°νν•κ³  μ‹¶μ€ μ—°λ Ήμ λ²”μ„λ¥Ό μ•λ ¤μ£Όμ„Έμ”~")
st.write("λ²”μ„λ¥Ό λ„“κ² μ΅μΌμ‹λ” κ±Έ μ¶”μ²λ“λ¦½λ‹λ‹¤.")
age_start = st.text_input("λ²”μ„μ μ‹μ‘ λ‚μ΄", placeholder="μ: 20")
age_end = st.text_input("λ²”μ„μ λ λ‚μ΄", placeholder="μ: 29")

if age_end != -1 and age_start != -1:
    st.write(f"λ‚μ΄ λ²”μ„: {age_start}μ„Έ ~ {age_end}μ„Έ")

st.divider()

#3. μ„±λ³„ gender
st.header("3. μ„±λ³„ μ„ νƒ")
age_group = st.radio(
    "μ„±λ³„μ„ μ„ νƒν•μ„Έμ”:",
    options=["μ „μ²΄", "μ—¬μ„±", "λ‚¨μ„±"],
)
st.write(age_group)
st.divider()

#4. νμ΄μ§€ ν¬κΈ° - ν• νμ΄μ§€λ‹Ή μ κ³ λλ” λ„μ„λ©λ΅ κ°μ μ§€μ • pagesize
st.header("4. λ„μ„ μ¶”μ² κ°μ")

page_size = st.text_input("μ›ν•μ‹λ” μ¶”μ²λ°›μΌμ‹¤ λ„μ„μ κ°μλ¥Ό μ•λ ¤μ£Όμ„Έμ” !",placeholder="μ: 5 (κΌ­ μ«μλ§ μ…λ ¥ν•΄μ£Όμ„Έμ” γ…γ…΅γ…)")
st.divider()

#5. λ„μ„κµ¬λ¶„ class_no λ¶„λ¥μ½”λ“ 
st.header("5. ν•κµ­ λ„μ„κµ¬λ¶„ λ¶„λ¥μ½”λ“!")
st.write("00 μ΄λ¥ 01 λ„μ„ν•™, μ„μ§€ν•™ 02 λ¬Έν—μ •λ³΄ν•™ 03 λ°±κ³Όμ‚¬μ „ 04 μΌλ° λ…Όλ¬Έμ§‘ 05 μΌλ° μ—°μ†κ°„ν–‰λ¬Ό 06 ν•™Β·ν‘ν,κΈ°κ΄€ 07 μ‹ λ¬Έ, μ–Έλ΅ , μ €λ„λ¦¬μ¦ 08 μΌλ° μ „μ§‘, μ΄μ„ 09 ν–¥ν† μλ£")
st.write("10 μ² ν•™ 11 ν•μ΄μƒν•™ 12 μΈμ‹λ΅ , μΈκ³Όλ΅ , μΈκ°„ν•™ 13 μ² ν•™μ μ²΄κ³„ 14 κ²½ν•™ 15 λ™μ–‘ μ² ν•™, μ‚¬μƒ 16 μ„μ–‘μ² ν•™ 17 λ…Όλ¦¬ν•™ 18 μ‹¬λ¦¬ν•™ 19 μ¤λ¦¬ν•™, λ„λ•μ² ν•™ ")
st.write("20 μΆ…κµ 21 λΉ„κµμΆ…κµν•™ 22 λ¶κµ 23 κΈ°λ…κµ 24 λ„κµ 25 μ²λ„κµ 26 μ‹ λ„ 27 λ°”λΌλ¬Έκµ, μΈλ„κµ 28 νκµ(μ΄μ¬λκµ) 29 κΈ°νƒ€ μ μΆ…κµ ")
st.write("30 μ‚¬νκ³Όν•™ 31 ν†µκ³„ν•™ 32 κ²½μ ν•™ 33 μ‚¬νν•™, μ‚¬νλ¬Έμ  34 μ •μΉν•™ 35 ν–‰μ •ν•™ 36 λ²•ν•™ 37 κµμ΅ν•™ 38 ν’μ†, λ―Όμ†ν•™ 39 κµ­λ°©, κµ°μ‚¬ν•™ 40 μμ—°κ³Όν•™ ")
st.write("41 μν•™ 42 λ¬Όλ¦¬ν•™ 43 ν™”ν•™ 44 μ²λ¬Έν•™ 45 μ§€ν•™ 46 κ΄‘λ¬Όν•™ 47 μƒλ¬Όκ³Όν•™ 48 μ‹λ¬Όν•™ 49 λ™λ¬Όν•™ ")
st.write("50 κΈ°μ κ³Όν•™ 51 μν•™52 λ†μ—…, λ†ν•™ 53 κ³µν•™, κ³µμ—…μΌλ°  54 κ±΄μ¶•κ³µν•™ 55 κΈ°κ³„κ³µν•™ 56 μ „κΈ°κ³µν•™, μ „μκ³µν•™ 57 ν™”ν•™κ³µν•™ 58 μ μ΅°μ—… 59 κ°€μ •ν•™ λ° κ°€μ •μƒν™ 60 μμ  ")
st.write("61 κ±΄μ¶•μ  62 μ΅°κ° 63 κ³µμ, μ¥μ‹λ―Έμ  64 μ„μ 65 νν™”, λ„ν™” 66 μ‚¬μ§„μ  67 μμ•… 68 μ—°κ·Ή 69 μ¤λ½, μ΄λ™ ")
st.write("70 μ–Έμ–΄ 71 ν•κµ­μ–΄ 72 μ¤‘κµ­μ–΄ 73 μΌλ³Έμ–΄ 74 μμ–΄ 75 λ…μΌμ–΄ 76 ν”„λ‘μ¤μ–΄ 77 μ¤νμΈμ–΄ 78 μ΄νƒλ¦¬μ•„μ–΄ 79 κΈ°νƒ€ μ μ–΄ 80 λ¬Έν•™ ")
st.write("81 ν•κµ­λ¬Έν•™ 82 μ¤‘κµ­λ¬Έν•™ 83 μΌλ³Έλ¬Έν•™ 84 μλ―Έλ¬Έν•™85 λ…μΌλ¬Έν•™ 86 ν”„λ‘μ¤λ¬Έν•™ 87 μ¤νμΈλ¬Έν•™ 88 μ΄νƒλ¦¬μ•„λ¬Έν•™ 89 κΈ°νƒ€ μ λ¬Έν•™ ")
st.write("90 μ—­μ‚¬ 91 μ•„μ‹μ•„(μ•„μ„Έμ•„) 92 μ λ½(κµ¬λΌν) 93 μ•„ν”„λ¦¬μΉ΄ 94 λ¶μ•„λ©”λ¦¬μΉ΄(λ¶λ―Έ) 95 λ‚¨μ•„λ©”λ¦¬μΉ΄(λ‚¨λ―Έ) 96 μ¤μ„Έμ•„λ‹μ•„(λ€μ–‘μ£Ό) 97 μ–‘κ·Ήμ§€λ°© 98 μ§€λ¦¬ 99 μ „κΈ° ")

divider_code = st.text_input("λ„μ„κµ¬λ¶„ λ¶„λ¥μ½”λ“λ¥Ό μ…λ ¥ν•΄μ£Όμ„Έμ” !",placeholder="μμ‹ : 41 (μν•™μ„ ν¬λ§ν•λ” κ²½μ°)")
st.divider()

# μ¶”μ² λ„μ„ κ²°κ³Ό λ²„νΌ
if st.button("μ¶”μ² λ„μ„ ν™•μΈ"):
    st.subheader("π“ μ¶”μ² λ„μ„ λ©λ΅")
    # μ—¬κΈ°μ„ λ„μ„κ΄€μ •λ³΄λ‚λ£¨ APIλ¥Ό νΈμ¶ν•μ—¬ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤κ³ , κ²°κ³Όλ¥Ό ν‘μ‹
    st.write(f"μ„ νƒν• λ„μ„κ΄€: {selected_library}")
    st.write(f"μ…λ ¥ν• κ΄€μ‹¬μ‚¬: {interest}")
    st.write(f"μ„ νƒν• μ—°λ Ήλ€: {age_group}")
    st.info("μ¶”μ² λ„μ„ λ©λ΅μ€ APIλ¥Ό ν†µν•΄ κ³§ μ κ³µλ  μμ •μ…λ‹λ‹¤.")
    
    # request


# μ¶”κ°€ μ •λ³΄ μ„Ήμ…
st.sidebar.title("π“– λ„μ›€λ§")
st.sidebar.info(
    """
    1. λ„μ„κ΄€μ„ μ„ νƒν•μ„Έμ”.
    2. κ΄€μ‹¬ μλ” μ£Όμ λ¥Ό μ…λ ¥ν•μ„Έμ”.
    3. μ—°λ Ήλ€λ¥Ό μ„ νƒν•λ©΄ λ§μ¶¤ λ„μ„λ¥Ό μ¶”μ²λ°›μ„ μ μμµλ‹λ‹¤.
    """
)

st.sidebar.title("π“– λ„μ›€λ§")
st.sidebar.info(
    """
    1. λ„μ„κ΄€μ„ μ„ νƒν•μ„Έμ”.
    2. κ΄€μ‹¬ μλ” μ£Όμ λ¥Ό μ…λ ¥ν•μ„Έμ”.
    3. μ—°λ Ήλ€λ¥Ό μ„ νƒν•λ©΄ λ§μ¶¤ λ„μ„λ¥Ό μ¶”μ²λ°›μ„ μ μμµλ‹λ‹¤.
    """
)




